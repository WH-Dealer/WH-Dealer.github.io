(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{8312:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return s(5009)}])},5009:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return N}});var n=s(5893),l=s(8566),i=s(7645),a=s(6514),r=s(8951),c=s(1425),o=s(9008),d=s.n(o),h=s(7294),x=s(4105),m=s(8456),u=s(2630);let f=h.forwardRef((e,t)=>{let{className:s="",loading:l,children:i,disabled:a,...r}=e;return(0,n.jsxs)(u.Z,{ref:t,...r,disabled:l||a,className:"!flex !justify-center !items-center ".concat(s),children:[(0,n.jsx)("div",{className:"flex items-center justify-center ".concat(l?"invisible":""),children:i}),l&&(0,n.jsx)(m.Z,{size:18,className:"absolute"})]})});f.displayName="Button";var g=s(8078);let p=e=>{let{width:t,height:s,src:l}=e;return l?(0,n.jsx)("img",{className:"flex",alt:"",src:l,style:{width:t,height:s}}):(0,n.jsx)(g.Z,{animation:"wave",width:t,height:s})};var j={src:"/next/static/media/download.5a737341.svg",height:512,width:512},v=s(3050);let w=e=>"https://www.webarcode.com/barcode/image.php?code=".concat(e,"&type=C128B&xres=1&height=").concat(50,"&width=").concat(240,"&font=3&output=png&style=197"),b=()=>{let e=(0,h.useRef)(null),t=(0,h.useRef)(null),[s,o]=(0,h.useState)({items:[],index:0}),[m,u]=(0,h.useState)({open:!1,message:""}),[g,b]=(0,h.useState)(!1),{items:N,index:y}=s,k=!!N.length,C=(0,h.useRef)([]),R=e=>{let s=x.ij(e,{type:"array"}),n=s.SheetNames[0],l=s.Sheets[n],i=x.P6.sheet_to_json(l,{header:1});if(0===((null==i?void 0:i.length)||0))return;let a=i.map(e=>{let[t,s]=e;return{img:new Image,text:t,count:s}}),r=a.map(()=>null);C.current=a.map((e,t)=>new Promise(e=>{r[t]=e}));let c=0,d=setInterval(()=>{let e=c,t=a[c].img;t.crossOrigin="anonymous",t.onload=()=>{let s=document.createElement("canvas");s.width=t.width,s.height=t.height,s.getContext("2d").drawImage(t,0,0),s.toBlob(async t=>{let s=URL.createObjectURL(t);o(n=>{let l={...n};return l.items[e].src=s,l.items[e].blob=t,l}),setTimeout(()=>r[e](null),0)},"image/jpeg")},t.onerror=()=>r[e](null),t.src=w(a[c].text),(c+=1)===i.length&&clearInterval(d)},50);o({items:a,index:0}),t.current.focus()},_=e=>{var t;if(!(null===(t=e.target.files)||void 0===t?void 0:t[0]))return;let s=new FileReader;s.onload=e=>{var t;R(null===(t=e.target)||void 0===t?void 0:t.result)},s.readAsArrayBuffer(e.target.files[0]),e.target.value=null},B=function(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];return()=>{o(t=>{let s=t.index+(e?1:-1);return s<0?(s=0,u({open:!0,message:"Bạn hiện đ\xe3 ở trang đầu ti\xean"})):s>=t.items.length&&(s=t.items.length-1,u({open:!0,message:"Bạn hiện đ\xe3 ở trang cuối c\xf9ng"})),{...t,index:s}})}},E=()=>u({...m,open:!1}),Z=async()=>{b(!0),await Promise.all(C.current);let e=new v.Document({sections:[{properties:{},children:N.map(e=>(console.log(e.blob),new v.Paragraph({children:[new v.ImageRun({data:e.blob,transformation:{width:240,height:50}})]})))}]});v.Packer.toBlob(e).then(e=>{e=e.slice(0,e.size,"octet/stream");let t=URL.createObjectURL(e),s=document.createElement("a");s.href=t,s.download="codes.docx",s.click(),window.URL.revokeObjectURL(t),b(!1)})},z=B(!1),L=B(!0);return(0,h.useEffect)(()=>{let e=e=>{switch(e.key){case"ArrowLeft":z();break;case"ArrowRight":L()}};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}},[]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(d(),{children:[(0,n.jsx)("title",{children:"Kiểm k\xea h\xe0ng ng\xe0y"}),(0,n.jsx)("meta",{name:"description",content:"Generated by create next app"}),(0,n.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1"}),(0,n.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,n.jsxs)(l.Z,{open:m.open,onClose:E,children:[(0,n.jsx)(i.Z,{children:"Th\xf4ng b\xe1o"}),(0,n.jsx)(a.Z,{className:"w-[320px]",children:(0,n.jsx)(r.Z,{id:"alert-dialog-description",children:m.message})}),(0,n.jsx)(c.Z,{className:"!p-4",children:(0,n.jsx)(f,{variant:"contained",onClick:E,children:"Đ\xf3ng"})})]}),(0,n.jsx)("div",{className:"fixed top-0 z-40 w-full backdrop-blur flex-none border-0 border-b border-solid border-slate-900/10 bg-white supports-backdrop-blur:bg-white/95",children:(0,n.jsx)("div",{className:"max-w-8xl mx-auto",children:(0,n.jsx)("div",{className:"py-4 lg:px-8 mx-4 lg:mx-0",children:(0,n.jsxs)("div",{className:"relative flex items-center",children:[(0,n.jsx)("svg",{viewBox:"0 0 52 31",className:"h-5 mr-4",children:(0,n.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M25.517 0C18.712 0 14.46 3.382 12.758 10.146c2.552-3.382 5.529-4.65 8.931-3.805 1.941.482 3.329 1.882 4.864 3.432 2.502 2.524 5.398 5.445 11.722 5.445 6.804 0 11.057-3.382 12.758-10.145-2.551 3.382-5.528 4.65-8.93 3.804-1.942-.482-3.33-1.882-4.865-3.431C34.736 2.92 31.841 0 25.517 0zM12.758 15.218C5.954 15.218 1.701 18.6 0 25.364c2.552-3.382 5.529-4.65 8.93-3.805 1.942.482 3.33 1.882 4.865 3.432 2.502 2.524 5.397 5.445 11.722 5.445 6.804 0 11.057-3.381 12.758-10.145-2.552 3.382-5.529 4.65-8.931 3.805-1.941-.483-3.329-1.883-4.864-3.432-2.502-2.524-5.398-5.446-11.722-5.446z",fill:"#38bdf8"})}),(0,n.jsx)("span",{className:"font-bold text-xl logo",children:"KKHN"}),(0,n.jsx)("div",{className:"ml-4 text-xs leading-5 font-medium text-sky-600 bg-sky-400/10 rounded-full py-1 px-3 hidden xl:flex items-center hover:bg-sky-400/20",children:(0,n.jsx)("strong",{className:"font-semibold",children:"Kiểm k\xea h\xe0ng ng\xe0y"})}),(0,n.jsx)("div",{className:"hidden lg:flex items-center ml-auto",children:(0,n.jsxs)("div",{className:"flex items-center border-l border-slate-200 ml-6 pl-6",children:[(0,n.jsx)("span",{className:"text-sm text-slate-500",children:"By KnightZ"}),(0,n.jsx)("a",{href:"https://github.com/WHKnightZ",className:"ml-6 block text-slate-400 hover:text-slate-500",children:(0,n.jsx)("svg",{viewBox:"0 0 16 16",className:"w-5 h-5",fill:"currentColor",children:(0,n.jsx)("path",{d:"M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"})})})]})})]})})})}),(0,n.jsxs)("main",{className:"w-screen h-screen flex items-center justify-center",children:[(0,n.jsx)("span",{className:"credit p-4 fixed top-0 right-0 font-medium",children:"By Kh\xe1nh"}),(0,n.jsx)("input",{hidden:!0,type:"file",ref:e,accept:".xlsx",onChange:_}),(0,n.jsxs)("div",{className:"flex flex-col items-center",children:[(0,n.jsx)(f,{variant:"contained",onClick:()=>e.current.click(),children:"Chọn file"}),(0,n.jsxs)("div",{className:"code mt-4",style:{height:k?98:0,opacity:k?1:0},children:[N[y]&&(0,n.jsxs)("div",{className:"flex items-center justify-center relative",children:[(0,n.jsx)(p,{src:N[y].src,width:240,height:50}),(0,n.jsxs)("div",{className:"absolute right-[-20px] text-center text-[#0865df]",style:{transform:"translateX(100%)"},children:[(0,n.jsx)("div",{className:"text-xs",children:"Số lượng"}),(0,n.jsx)("div",{className:"font-bold",children:N[y].count})]})]}),(0,n.jsxs)("div",{className:"flex mt-4 gap-3 justify-center",children:[(0,n.jsx)(f,{size:"small",onClick:z,children:"Trở lại"}),(0,n.jsx)(f,{size:"small",variant:"contained",onClick:L,ref:t,children:"Tiếp theo"}),(0,n.jsx)(f,{size:"small",className:"!min-w-0 !px-3",onClick:Z,loading:g,children:(0,n.jsx)("img",{alt:"",src:j.src,className:"w-5 h-5"})})]})]})]})]})]})};var N=b},5103:function(){},2061:function(){}},function(e){e.O(0,[251,301,558,774,888,179],function(){return e(e.s=8312)}),_N_E=e.O()}]);